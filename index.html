<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Points Table — Tanbeeh & Tashjeeh</title>

<!-- FONTS -->
<style>
@font-face {font-family:Poppins;font-style:normal;font-weight:400;src:url(/cf-fonts/s/poppins/5.0.11/latin/400/normal.woff2);}
@font-face {font-family:Poppins;font-style:normal;font-weight:500;src:url(/cf-fonts/s/poppins/5.0.11/latin/500/normal.woff2);}
@font-face {font-family:Poppins;font-style:normal;font-weight:600;src:url(/cf-fonts/s/poppins/5.0.11/latin/600/normal.woff2);}
@font-face {font-family:Poppins;font-style:normal;font-weight:700;src:url(/cf-fonts/s/poppins/5.0.11/latin/700/normal.woff2);}
</style>

<style>
:root {
  --primary: #c9a574;
  --primary-dark: #a98251;
  --shadow: 0 20px 50px rgba(0,0,0,0.35);
}

/* ============================================================= */
/*                         BODY DESIGN                           */
/* ============================================================= */
* { margin:0; padding:0; box-sizing:border-box; }

body {
  font-family: 'Poppins', sans-serif;
  min-height: 100vh;
  padding: 15px 10px;
  color: white;
  background: url("https://i.ibb.co/STgCyhR/jamea.jpg") center/cover no-repeat fixed;
  position: relative;
  overflow: hidden; /* disabled until loader hides */
}

body::before {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.45);
  backdrop-filter: blur(8px);
  z-index: -1;
}

/* ============================================================= */
/*               ULTRA PREMIUM LOADING SCREEN                    */
/* ============================================================= */
.loader-overlay {
  position: fixed;
  inset: 0;
  background: radial-gradient(circle at top, #1a1a1a, #000);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 99999;
  overflow: hidden;
  animation: fadeLoader 1s ease forwards;
  animation-delay: 4.5s;
}

/* Floating particles */
.particles span {
  position: absolute;
  width: 8px;
  height: 8px;
  background: rgba(255,255,255,0.2);
  border-radius: 50%;
  animation: rise 10s infinite ease-in;
}
.particles span:nth-child(1) { left: 10%; animation-delay: 0s; }
.particles span:nth-child(2) { left: 30%; animation-delay: 2s; }
.particles span:nth-child(3) { left: 50%; animation-delay: 4s; }
.particles span:nth-child(4) { left: 70%; animation-delay: 1s; }
.particles span:nth-child(5) { left: 90%; animation-delay: 3s; }
.particles span:nth-child(6) { left: 20%; animation-delay: 5s; }
.particles span:nth-child(7) { left: 80%; animation-delay: 6s; }
.particles span:nth-child(8) { left: 40%; animation-delay: 7s; }
.particles span:nth-child(9) { left: 60%; animation-delay: 8s; }
.particles span:nth-child(10){ left: 75%; animation-delay: 9s; }

@keyframes rise {
  0% { bottom: -20px; transform: translateX(0) scale(0.4); opacity: 0.3; }
  50% { opacity: 1; }
  100% { bottom: 110%; transform: translateX(20px) scale(1); opacity: 0; }
}

/* Glowing Logo */
.loader-circle {
  width: 170px;
  height: 170px;
  border-radius: 50%;
  background: linear-gradient(135deg, rgba(255,215,130,0.2), rgba(255,255,255,0.07));
  backdrop-filter: blur(12px);
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 0 40px rgba(201,165,116,0.5);
  animation: pulseGlow 2.4s infinite ease-in-out;
}

.loader-logo {
  width: 120px;
  height: 120px;
  object-fit: contain;
}

.loader-title {
  margin-top: 20px;
  font-size: 32px;
  font-weight: 700;
  color: #e5c28f;
  text-shadow: 0 0 30px rgba(255,200,150,0.7);
  letter-spacing: 2px;
  animation: fadeIn 1.5s ease;
}

.loader-subtitle {
  margin-top: 8px;
  font-size: 16px;
  color: #ccc;
  animation: fadeIn 2.2s ease;
}

/* Loading Bar */
.loading-bar {
  width: 200px;
  height: 5px;
  background: rgba(255,255,255,0.2);
  border-radius: 10px;
  overflow: hidden;
  margin-top: 25px;
}

.loading-progress {
  height: 100%;
  background: linear-gradient(90deg, #c9a574, #f7d7a2);
  width: 0%;
  animation: progressFill 4s ease forwards;
}

/* Animations */
@keyframes pulseGlow {
  0%,100% { transform: scale(1); box-shadow: 0 0 40px rgba(201,165,116,0.5); }
  50% { transform: scale(1.1); box-shadow: 0 0 60px rgba(201,165,116,0.7); }
}

@keyframes progressFill {
  to { width: 100%; }
}

@keyframes fadeLoader {
  to { opacity: 0; visibility: hidden; }
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

/* ============================================================= */
/*                    CONTENT & TABLE SECTION                    */
/* ============================================================= */
.container { max-width: 1100px; margin: 0 auto; }

.header {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 20px;
  margin-bottom: 30px;
  flex-wrap: wrap;
}

.logo img {
  width: 100px;
  height: 100px;
  border-radius: 50%;
  border: 5px solid rgba(255,255,255,0.5);
  box-shadow: 0 10px 30px rgba(0,0,0,0.4);
  background: white;
  padding: 8px;
  object-fit: contain;
}

h1 {
  font-size: 34px;
  color: white;
  font-weight: 700;
}

.card {
  background: rgba(255,255,255,0.15);
  backdrop-filter: blur(20px);
  border-radius: 24px;
  padding: 28px;
  box-shadow: var(--shadow);
}

.table-container {
  overflow-x: auto;
  border-radius: 20px;
  background: rgba(255,255,255,0.12);
  backdrop-filter: blur(10px);
}

table { width: 100%; border-collapse: collapse; font-size: 14.5px; }

th {
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  color: white;
  padding: 16px 12px;
  text-transform: uppercase;
}

td {
  padding: 14px 10px;
  text-align: center;
  border-bottom: 1px solid rgba(255,255,255,0.15);
}

.tan { background: rgba(198,40,40,0.3) !important; }
.tash { background: rgba(46,125,50,0.3) !important; }

.total-positive { color: #a8e6a8; font-weight: 700; }
.total-negative { color: #ff8a80; font-weight: 700; }
</style>
</head>


<body>

<!-- ============================================================= -->
<!--                PREMIUM ANIMATED LOADING SCREEN                -->
<!-- ============================================================= -->
<div class="loader-overlay">
  <div class="particles">
    <span></span><span></span><span></span><span></span>
    <span></span><span></span><span></span><span></span>
    <span></span><span></span>
  </div>

  <div class="loader-circle">
    <img src="https://i.ibb.co/Ndqj258K/panchgani-removebg-preview.png" class="loader-logo">
  </div>

  <h2 class="loader-title">Tanbeeh & Tashjeeh</h2>
  <p class="loader-subtitle">Preparing Your Dashboard...</p>

  <div class="loading-bar">
    <div class="loading-progress"></div>
  </div>
</div>


<!-- ============================================================= -->
<!--                         MAIN CONTENT                           -->
<!-- ============================================================= -->
<div class="container">
  <div class="header">
    <div class="logo">
      <img src="https://i.ibb.co/Ndqj258K/panchgani-removebg-preview.png">
    </div>

    <div class="title-group">
      <h1>Points Table</h1>
      <p class="subtitle">Tanbeeh & Tashjeeh – Live Standings</p>
    </div>
  </div>

  <div class="card">
    <div class="table-container">
      <table id="pointsTable">
        <thead>
          <tr>
            <th>No.</th>
            <th>Name</th>
            <th class="tan">Tanbeeh</th>
            <th class="tash">Tashjeeh</th>
            <th>Total</th>
          </tr>
        </thead>

        <tbody id="tableBody"></tbody>
      </table>
    </div>
  </div>
</div>


<!-- ============================================================= -->
<!--                       JAVASCRIPT SECTION                       -->
<!-- ============================================================= -->
<script>
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbxuYfx40BopDL4xhK1hWRADSmiJM8NzyfoiPU5kr9xtrH_KWj47HVt65PWrZTeChMWg/exec";

const NAMES = [
  "Burhanuddin ali mohammad bhai Bazar", "Abdulkadir M. Mustafa Bhai Hamid",
  "Taher Aliasger Bhai Musaji", "Mustafa Yusuf Bhai Dawoodi",
  "Mufaddal mustansir bhai rangwala", "Husain Murtaza bhai Ahemadabad",
  "Shabbir Habib Bhai Jalali", "Taher Dawood Bhai Suksar",
  "Mohammed Shk Huzaifa Shakir", "Burhanuddin Shabbir Bhai Sabunwala",
  "Adnan Juzer Bhai Banswadi", "Aziz Husain Saeed Abbas Bhai Saghar",
  "Burahanuddin hussain bhai chittalwala", "Husain mohammad bhai bootwala",
  "Mohammed Burhanuddin Bhai Gharyali", "Husain murtaza Fatehnagar",
  "Taha Firoz Bhai Petlawad", "Burhanuddin Juzer Bhai Saifee",
  "Ibrahim Aliasger Bhai Marhaba", "Qusai Mandasaur",
  "Taha Fakhruddin Bhagat", "Mohammed Mustafa bhai Dewaswala",
  "Burhanuddin Saleh Bhai Lakda", "Abdulqadir Haider Disa",
  "Mohammed Primas", "Mohammed Mustafa Bhai Qudrati",
  "Hussain Yusuf bhai kanore wala", "Ibrahim Hatim Bhai Pathari",
  "Murtaza Raj", "Mufaddal Yusuf Bhai Motor",
  "Hatim Abbas Bhai Kathana", "Behlul Khuzaima Saifee",
  "Mohammed Mustafa Bhai Paghri", "Hussain Sadri",
  "Fakhruddin murtaza bhai ezzy", "Taha Abbas Bhai Mhow"
];

async function fetchPoints() {
  try {
    const res = await fetch(`${WEB_APP_URL}?action=getPoints`);
    return await res.json();
  } 
  catch (err) {
    console.error("Error fetching points:", err);
    return null;
  }
}

function updateTable(data) {
  const tableBody = document.getElementById("tableBody");
  tableBody.innerHTML = "";

  data.forEach((student, i) => {
    const tan = student.tanbeeh || 0;
    const tash = student.tashjeeh || 0;
    const total = tash - tan;

    const row = `
      <tr>
        <td>${i+1}</td>
        <td style="text-align:left;">${NAMES[i]}</td>
        <td class="tan">${tan}</td>
        <td class="tash">${tash}</td>
        <td class="${total >= 0 ? 'total-positive' : 'total-negative'}">${total >= 0 ? '+'+total : total}</td>
      </tr>
    `;
    tableBody.innerHTML += row;
  });
}

function updateTimestamp() {
  const now = new Date();
  document.querySelector(".subtitle").innerHTML =
    `Tanbeeh & Tashjeeh – Live Standings • Last updated: ${now.toLocaleTimeString()}`;
}

async function loadData() {
  const data = await fetchPoints();
  if (data) {
    updateTable(data);
    updateTimestamp();
  }
}

setTimeout(() => {
  document.querySelector('.loader-overlay').style.display = 'none';
  document.body.style.overflow = 'auto';
}, 4500);

document.addEventListener("DOMContentLoaded", () => {
  loadData();
  setInterval(loadData, 10000);
});
</script>

</body>
</html>
